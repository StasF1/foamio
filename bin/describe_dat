#!/usr/bin/env python3
import argparse
from pathlib import Path

from foam2py import read_dat


def parse_arguments():
    parser = argparse.ArgumentParser(
        description='Describe .dat file using pandas.',
        formatter_class=argparse.ArgumentDefaultsHelpFormatter)

    parser.add_argument('loc',
                        metavar='FILE_OR_DIR',
                        type=Path,
                        help='.dat-file path or directory with .dat-files.')
    parser.add_argument('-uc',
                        '--usecols',
                        type=int,
                        nargs='+',
                        help='column indices (using header in .dat-file)')
    parser.add_argument('-un',
                        '--usenth',
                        type=int,
                        help='column indices (using header in .dat-file)')

    return parser.parse_args()


def main() -> None:

    args = parse_arguments()
    print(load_dat(args.loc, usecols=args.usecols, use_nth=args.usenth).describe())


if __name__ == '__main__':
    main()
